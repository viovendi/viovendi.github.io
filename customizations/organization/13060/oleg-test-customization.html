console.log('Start working, Google Tag Manager');
async function makeRequest(options) {
  let result = null;
  try {
      result = await $.ajax(options);
      return result;
  } catch (error) {
      console.error(error);
  }
}



console.log('GTM Tag - COMPLEX-187 (TEST)')


var pathname = window.location.pathname;
var eventId = pathname.split('/')[3]

async function getContainerId(eventId){
  const result = await makeRequest({
    url: `https://api.doo.net/v1/events/${eventId}`,
    type: 'get',
    headers: {
      'Content-Type': 'application/json',
    },
    dataType: 'json',
  })
  const id = result.event_attributes.attributes.filter(function (v) {
    if (v.name.includes('GTM-container')) {
      console.log(v.data)
      return v.data
    }
  });
  console.log(id)
  return id
}


const containerId = getContainerId(eventId)

console.log(containerId, 'containerId')